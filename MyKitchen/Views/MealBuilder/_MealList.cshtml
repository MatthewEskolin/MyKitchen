@model MealBuilderIndexViewModel

<form>
<div page-model="@Model.MealListPagingInfo" page-action="Index" page-classes-enabled="true"
     page-class="btn" page-class-normal="btn-secondary"
     page-class-selected="btn-primary" class="btn-group pull-left m-1">
</div>

<table class="table table-light">
    <thead>

    @* Should be a plate or a takeout bag if the meal is takeout *@
    <th scope="col"></th>
    <th scope="col">Name</th>
    <th scope="col">Food Items</th>
    <th scope="col">Satiety Profile</th>
    <th scope="col">Edit</th>
    <th scope="col">Favorite</th>
    </thead>
    <tbody>
    @foreach(var item in Model.Meals)
    {
        <tr>
            <td>
                <img src="/images/plate-with-orange-pattern.svg" style="width: 70px;"/>
            </td>
            <td>
                @item.MealName
            </td>
            <td>
                @foreach(var foodItem in item.MealFoodItems){
                    <ul>
                    @foodItem.FoodItems.FoodItemName
                    </ul>
                }
            </td>
            <td>
                Tasty
            </td>
            <td>
                <a style="display: none;" asp-action="SelectFoodItemsForMeal" asp-route-mealId="@item.MealID">Select</a>
                <a asp-action="MealDetails" asp-route-mealId="@item.MealID">Select</a>

            </td>
            <td>
                
                <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" class="@GetFavoritesClass(item.IsFavorite) favImage" onclick="SetFavorite(this,@item.IsFavorite)" /> </td> </tr> }
    </tbody>
</table>

<div page-model="@Model.MealListPagingInfo" page-action="Index" page-classes-enabled="true"
     page-class="btn" page-class-normal="btn-secondary"
     page-class-selected="btn-primary" class="btn-group pull-left m-1">
</div>


</form>

@functions{ 
  public string GetFavoritesClass(bool isFavorite) 
    {
        return isFavorite ? "bg-fav" : "bg-nofav";
    }


}


@section Scripts {

    @* <script type="text/javascript">
        //Change Image Source on Hover


        document.addEventListener('rowclick', function (e) {
                console.log('data: ', e.detail.data);
                console.log('grid: ', e.detail.grid);
                console.log('original event: ', e.detail.originalEvent);

        });
    </script> *@

    <script type="text/javascript">
    
        public int setFavorite(img,isFavorite){

            if(isFavorite == true) { isFav = 1; } else { isFav = 0; }

            $.ajax({ 
                type:"POST",
                url:`/MealBuilder/SetFavorite/${isFav}`
                success:function(data){


                },
                error:function(error){
                    console.log(error);
                }

            });
        }

    
    </script>



    }
}